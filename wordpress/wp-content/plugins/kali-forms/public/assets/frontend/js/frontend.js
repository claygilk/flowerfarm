(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{36:function(t,e,n){"use strict";n.r(e);var r=n(3),i=n.n(r),a=n(4),o=n.n(a),s=n(1),c=n(12),u=n.n(c),l=n(13),d=n.n(l),f=n(14),h=n.n(f),m=n(15),p=n.n(m);function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),t}function b(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var k={gatherProducts:function(){var t=this,e={action:"kaliforms_form_verify_products",data:{formId:this.formId}};this.axios.post(KaliFormsObject.ajaxurl,this.Qs.stringify(e)).then(function(e){t._products="ok"===e.data.response?[]:e.data.response}).catch(function(t){console.log(t)})},getCart:function(){var t=this,e=0,n="USD",r=[];return this._products.map(function(i){t._payee=void 0!==i.payee?i.payee:null,"product"===i.type&&(e+=parseInt(i.price),r.push(i.caption)),"multipleProducts"===i.type&&t.isSelectedPrice(i)&&(e+=parseInt(i.price),r.push(i.caption)),n=i.currency}),{price:e.toFixed(2),description:r.join(","),currency:n}},isSelectedPrice:function(t){var e=b(document.querySelectorAll('[data-internal-id="'.concat(t.id.toLowerCase(),'"]')));return!!e.length&&(void 0!==e.find(function(t){return t.checked})&&(parseInt(e.find(function(t){return t.checked}).value)===parseInt(t.price)||void 0))},onApprove:function(t,e){var n=this;return this.loading=!0,e.order.capture().then(function(t){n.payments={payment_id:t.id,payer:t.payer,status:t.status},n.loading=!1,n.form.dispatchEvent(new Event("submit"))})},createOrder:function(t,e){var n=this.getCart(),r={purchase_units:[{amount:{value:n.price,currency_code:n.currency},description:n.description}]};return null!==this._payee&&(r.purchase_units[0].payee={email_address:this._payee}),e.order.create(r)},onInit:function(t,e){var n=this;this.validForm()?e.enable():e.disable(),this.form.addEventListener("change",function(t){n.validForm()?e.enable():e.disable()})},onClick:function(t,e){b(this.formElements).map(function(t){t.reportValidity()})},handlePayPalPayment:function(t){this.gatherProducts(),this.createOrder=this.createOrder.bind(this),this.onApprove=this.onApprove.bind(this),this.onInit=this.onInit.bind(this),this.onClick=this.onClick.bind(this),t.Buttons({onInit:this.onInit,onClick:this.onClick,createOrder:this.createOrder,onApprove:this.onApprove}).render("#kaliforms-paypal-button-container")}};function w(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _(t,e,n){return e&&O(t.prototype,e),n&&O(t,n),t}var E=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._timeout=7e3,this._url=KaliFormsObject.ajaxurl,this._labels=KaliFormsObject.translations.filePond}return g(t,[{key:"url",get:function(){return this._url},set:function(t){this._url=t}},{key:"timeout",get:function(){return this._timeout},set:function(t){this._timeout=parseInt(t)}},{key:"process",get:function(){var t=this,e=this;return function(n,r,i,a,o,s,c){var u=new FormData;u.append("action","kaliforms_form_upload_file"),u.append(n,r,r.name);var l=new XMLHttpRequest;return l.open("POST",t.url),l.upload.onprogress=function(t){s(t.lengthComputable,t.loaded,t.total)},l.onload=function(){if(l.status>=200&&l.status<300){if(e.isJson(l.response))if(JSON.parse(l.response).hasOwnProperty("errors"))return o("something went wrong");a(l.responseText)}else o("oh no")},l.send(u),{abort:function(){l.abort(),c()}}}}},{key:"revert",get:function(){var t=this;return function(e,n,r){var i=new FormData;i.append("action","kaliforms_form_delete_uploaded_file"),i.append("id",parseFloat(e));var a=new XMLHttpRequest;a.open("POST",t.url),a.send(i),n()}}},{key:"settings",get:function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){v(t,e,n[e])})}return t}({server:{url:this.url,timeout:this.timeout,process:this.process,revert:this.revert}},this._labels)}}]),g(t,[{key:"isJson",value:function(t){try{JSON.parse(t)}catch(t){return!1}return!0}}]),t}());s.setOptions(E.settings),s.registerPlugin(u.a),s.registerPlugin(d.a),s.registerPlugin(h.a),s.registerPlugin(p.a);var P=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.getAttribute("id"),this.formId=parseInt(e.getAttribute("data-form-id")),this.form=e,this.formElements=this.form.elements,this.uploadFields=[],this.nonce=KaliFormsObject.ajax_nonce,this.axios=i.a,this.Qs=o.a,this.handleFileUploads(),this.handleRecaptcha(),this.handleSubmit(),this.handlePayments(k),"undefined"!=typeof paypal&&this.handlePayPalPayment(paypal),document.dispatchEvent(new CustomEvent("kaliFormProcessConstructed",{detail:this}))}return _(t,[{key:"loading",set:function(t){this._loading=t,t?this.appendLoader():this.removeLoader()},get:function(){return this._loading}},{key:"valid",get:function(){var t={formValidation:!0};return this.grecaptcha&&(t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){A(t,e,n[e])})}return t}({},t,{recaptcha:this.grecaptchaValidation})),this.grecaptcha?t.formValidation&&t.recaptcha:t.formValidation}}]),_(t,[{key:"handlePayments",value:function(t){for(var e in t)this[e]=t[e].bind(this);this.payments=null,this.paymentForm=!0}},{key:"handleFileUploads",value:function(){var t=this;w(this.form.querySelectorAll("[type='file']")).map(function(e){var n=s.create(e);t.uploadFields.push(e.getAttribute("name"));var r={required:e.hasAttribute("required"),name:e.getAttribute("name"),disabled:e.hasAttribute("readonly"),allowImagePreview:e.hasAttribute("imagepreview"),maxFileSize:e.getAttribute("data-maxfilesize"),instantUpload:e.hasAttribute("instantupload"),acceptedFileTypes:null!==e.getAttribute("data-acceptedextensions")?e.getAttribute("data-acceptedextensions").split(","):null,fileRenameFunction:function(t){var n=e.getAttribute("data-fileprefix");return null!==n?"".concat(n).concat(t.name):t.name},oninit:function(){return document.dispatchEvent(new CustomEvent("kaliFormUploadFieldInit",{detail:{name:e.getAttribute("name"),instance:n}}))}};n.setOptions(r)})}},{key:"handleRecaptcha",value:function(){var t=this;this.grecaptcha=!1;var e=document.querySelectorAll("[data-field-type='grecaptcha']");(e=w(e)).length&&"undefined"!=typeof grecaptcha&&(this.grecaptcha=!0,grecaptcha.ready(function(){e.map(function(e){grecaptcha.render(e.getAttribute("id"),{sitekey:e.getAttribute("data-sitekey"),callback:t.verifyRecaptchaCallback.bind(t)})})}))}},{key:"verifyRecaptchaCallback",value:function(t){var e=this,n={action:"kaliforms_form_verify_recaptcha",data:{formId:this.formId,nonce:this.nonce,token:t}};this.axios.post(KaliFormsObject.ajaxurl,this.Qs.stringify(n)).then(function(t){t.data.hasOwnProperty("error")?e.throwError():e.grecaptchaValidation=t.data.response.success}).catch(function(t){console.log(t)})}},{key:"setupValidation",value:function(){}},{key:"handleSubmit",value:function(){var t=this;this.form.addEventListener("submit",function(e){e.preventDefault(),document.getElementById("kaliforms-global-error-message-".concat(t.formId)).style.display="none",t.loading=!0,t.valid?t.makeRequest():t.throwError()},!0)}},{key:"throwError",value:function(){document.getElementById("kaliforms-global-error-message-".concat(this.formId)).style.display="block",this.loading=!1}},{key:"makeRequest",value:function(){var t=this,e={action:"kaliforms_form_process",data:this._getFormData(),extraArgs:this._getExtra()};this.paymentForm&&(e.payments=this.payments),i.a.post(KaliFormsObject.ajaxurl,o.a.stringify(e)).then(function(e){e.data.hasOwnProperty("error")?t.throwError():(t.loading=!1,t.showThankYouMessage(e.data),e.data.hasOwnProperty("redirect_url")&&""!==e.data.redirect_url&&setTimeout(function(){return window.location.href=e.data.redirect_url},5e3))}).catch(function(t){console.log(t)})}},{key:"_getExtra",value:function(){return this.uploadFields}},{key:"_getFormData",value:function(){var t={formId:this.formId,nonce:this.nonce};return w(this.formElements).map(function(e){switch(e.getAttribute("type")){case"checkbox":var n=[];w(document.getElementsByName(e.getAttribute("name"))).map(function(t){return!!t.checked&&n.push(t.value)}),t[e.getAttribute("name")]=n;break;case"radio":var r="";w(document.getElementsByName(e.getAttribute("name"))).map(function(t){return!!t.checked&&(r=t.value)}),t[e.getAttribute("name")]=r;break;case"submit":break;case"choices":var i=e.querySelectorAll("option:checked");t[e.getAttribute("name")]=Array.from(i).map(function(t){return t.value});break;default:null!==e.getAttribute("name")&&(t[e.getAttribute("name")]=e.value)}}),t}},{key:"showThankYouMessage",value:function(t){var e=this;this.form.classList.add("fade-out-top");var n=this.whichAnimationEvent();n&&this.form.addEventListener(n,function(){e.form.insertAdjacentHTML("beforebegin",'<div id="kaliforms-thank-you-message">'.concat(t.thank_you_message,"</div>")),e.form.parentNode.removeChild(e.form)})}},{key:"appendLoader",value:function(){this.form.classList.add("kaliform-loading");this.form.insertAdjacentHTML("beforeend",'<div id="kaliform-loader-container" class="kaliform-loader-container"><div class="kaliform-loader"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>')}},{key:"removeLoader",value:function(){var t=document.getElementById("kaliform-loader-container");this.form.classList.remove("kaliform-loading"),this.form.removeChild(t)}},{key:"validForm",value:function(){var t=!0;return w(this.formElements).map(function(e){e.checkValidity()||(t=!1)}),t}},{key:"whichAnimationEvent",value:function(){var t,e=document.createElement("fakeelement"),n={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(t in n)if(void 0!==e.style[t])return n[t]}}]),t}();n(37);document.addEventListener("DOMContentLoaded",function(){var t=document.querySelectorAll(".kaliforms-form-container");Array.prototype.forEach.call(t,function(t){new P(t)})},!1)},37:function(t,e){}},[[36,1,2]]]);